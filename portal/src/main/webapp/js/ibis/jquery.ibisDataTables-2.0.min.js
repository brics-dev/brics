/**
 * IBIS DataTables 2.0
 * 
 * Contains all files needed to perform the IBIS DataTables javascript
 * processes.
 * 
 * Contents:
 * OpButtonController 	Controls buttons on top of datatables
 * DataTableLanguage
 * Row
 * TableCol
 * Rows
 * TableCols
 * DataTable		-	Model for an individual DataTable
 * DataTables		-	Collection of DataTable models
 * DataTableView	-	View class for rendering the datatable
 * DataTableViews	-	Collection of DataTableView classes
 * IBISDataTables	-	API Class for other developers to interface with
 * 
 */

// OpButtonController
var OpButtonController={initialized:!1,noneSelected:function(a){a.hasClass("alwaysEnabled")||a.hasClass("enabledOnNone")?a.prop("disabled",!1):a.prop("disabled",!0)},oneSelected:function(a){a.hasClass("alwaysDisabled")?a.prop("disabled",!0):a.prop("disabled",!1)},manySelected:function(a){a.hasClass("alwaysEnabled")||a.hasClass("enabledOnMany")?a.prop("disabled",!1):a.prop("disabled",!0)},initTable:function(a){var b=a.parent().parent().children("ul"),c=b.parents(".dataTableContainer").eq(0);if(b.length>0){var d=a.parent().children(":first");$(d).prepend($(b))}$(".ui-widget-header").append('<div class="clearboth"></div>'),c.find('input[type="submit"], input[type="button"], button').prop("disabled",!0),c.find('input[type="button"].alwaysEnabled, button.alwaysEnabled, input[type="button"].enabledOnNone, button.enabledOnNone').prop("disabled",!1),c.find('input[type="submit"].alwaysEnabled, submit.alwaysEnabled, input[type="submit"].enabledOnNone, submit.enabledOnNone').prop("disabled",!1),this.initialized||(EventBus.on("select:row",function(a,b){this.selectedChange(null,b.get("$el"))},this),EventBus.on("deselect:row",function(a,b){this.selectedChange(null,b.get("$el"))},this),EventBus.on("select:all",function(a){this.selectedChange(null,a.get("$el"))},this),EventBus.on("deselect:all",function(a){this.selectedChange(null,a.get("$el"))},this),EventBus.on("select:set",function(a,b){this.selectedChange(null,b.get("$el"))},this),this.initialized=!0)},drawRedrawTable:function(a){a.find('input[type="button"], button').each(function(a,b){OpButtonController.noneSelected($(this))})},selectedChange:function(a,b){var c=0,d=$();c="undefined"==typeof b?IDT.countSelectedOptions(IDT.getTable(a)):IDT.countSelectedOptions(b),d="undefined"==typeof b?IDT.getTableContainer(a):IDT.getTableContainer(b),d.find('input[type="submit"], input[type="button"], button').each(function(a,b){c<1?OpButtonController.noneSelected($(this)):1==c?OpButtonController.oneSelected($(this)):OpButtonController.manySelected($(this))})}};

// DataTableLanguage
var DataTableLanguage={language:function(){return"undefined"==typeof language||""==language?this.oLanguage_en_US:language.indexOf("zh")>-1?this.oLanguage_zh_TW:language.indexOf("es")>-1?this.oLanguage_es:this.oLanguage_en_US},oLanguage_en_US:{oAria:{sSortAscending:": activate to sort column ascending",sSortDescending:": activate to sort column descending"},oPaginate:{sFirst:"First",sLast:"Last",sNext:"Next",sPrevious:"Previous"},sEmptyTable:"No data available in table",sInfo:"Showing _START_ to _END_ of _TOTAL_ entries",sInfoEmpty:"Showing 0 to 0 of 0 entries",sInfoFiltered:"(filtered from _MAX_ total entries)",sInfoPostFix:"",sInfoThousands:",",sLengthMenu:"Show _MENU_ entries",sLoadingRecords:"Loading...",sProcessing:"Processing...",sSearch:"Search:",sUrl:"",sZeroRecords:"No matching records found"},oLanguage_zh_TW:{sProcessing:"\u8655\u7406\u4e2d...",sLengthMenu:"\u986f\u793a _MENU_ \u9805\u7d50\u679c",sZeroRecords:"\u6c92\u6709\u5339\u914d\u7d50\u679c",sInfo:"\u986f\u793a\u7b2c _START_ \u81f3 _END_ \u9805\u7d50\u679c\uff0c\u5171 _TOTAL_ \u9805",sInfoEmpty:"\u986f\u793a\u7b2c 0 \u81f3 0 \u9805\u7d50\u679c\uff0c\u5171 0 \u9805",sInfoFiltered:"(\u5f9e _MAX_ \u9805\u7d50\u679c\u904e\u6ffe)",sInfoPostFix:"",sSearch:"\u641c\u7d22:",sUrl:"",oPaginate:{sFirst:"\u9996\u9801",sPrevious:"\u4e0a\u9801",sNext:"\u4e0b\u9801",sLast:"\u5c3e\u9801"}},oLanguage_sp:{sProcessing:"Procesando...",sLengthMenu:"Mostrar _MENU_ registros",sZeroRecords:"No se encontraron resultados",sEmptyTable:"Ning\xfan dato disponible en esta tabla",sInfo:"Mostrando registros del _START_ al _END_ de un total de _TOTAL_ registros",sInfoEmpty:"Mostrando registros del 0 al 0 de un total de 0 registros",sInfoFiltered:"(filtrado de un total de _MAX_ registros)",sInfoPostFix:"",sSearch:"Buscar:",sUrl:"",sInfoThousands:",",sLoadingRecords:"Cargando...",oPaginate:{sFirst:"Primero",sLast:"\xdaltimo",sNext:"Siguiente",sPrevious:"Anterior"},fnInfoCallback:null,oAria:{sSortAscending:": Activar para ordernar la columna de manera ascendente",sSortDescending:": Activar para ordernar la columna de manera descendente"}}};

// Row
var Row=BaseModel.extend({defaults:{saveValue:"",data:[],expandedData:"",expandedDataIndex:-1,index:-1,disabled:false},initialize:function(){this.set("saveValue",IDT.getSaveValue(this))},html:function(){var e=this.get("data");var t="<tr>";for(var n=0;n<e.length;n++){t+="<td>"+e[n]+"</td>"}t+="</tr>";return t},getCellDataHtml:function(e){var t=this.get("data");if(e>0&&e<t.length){return t[e]}return undefined},getCellDataText:function(e){var t=this.get("data");if(e>0&&e<t.length){var n=t[e];return $(n).text()}return undefined},getInput:function(){var e=$();var t=this.get("data")[0];try{e=$(t)}catch(n){}return e}});

// TableCol
var TableCol=BaseModel.extend({defaults:{sortable:!0,visible:!0,title:"",index:0},initialize:function(){},dtObj:function(){return{}}});

// Rows
var Rows=Backbone.Collection.extend({initialize:function(){this.model=Row},bySaveVal:function(a){return this.findWhere({saveValue:a})}});

// TableCols
var TableCols=Backbone.Collection.extend({initialize:function(){this.model=TableCol},indexByName:function(a){return this.findWhere({title:a})}});

// DataTable
var DataTable=BaseModel.extend({rows:null,columns:null,selectedRows:null,defaults:{id:null,rendered:!1,$el:null,aaData:[],aoColumns:[],datatable:null,inputType:"none",exportRow:"",selectionDisable:!1,disableSelectAll:!1,config:{},expandedDataIndex:-1},initialize:function(){this.rows=new Rows,this.columns=new TableCols,this.selectedRows=new Rows},loadData:function(e){this.loadColumns(e.aoColumns),this.loadRows(e.aaData)},loadColumns:function(e){this.set("aoColumns",e);for(var t=0;t<e.length;t++){var s=e[t],i=!("ibisDatatable_expandedData"==s.sTitle),n=!0;0==t&&"none"!==this.get("inputType")&&(n=!1),this.columns.create({title:s.sTitle,sortable:n,visible:i,index:t})}},loadRows:function(e){this.set("aaData",e);for(var t=this.get("expandedDataIndex"),s=0;s<this.columns.length;s++)if(this.columns.at(s).get("visible")===!1){t=s;break}this.set("expandedDataIndex",t);for(var i=0;i<e.length;i++){var n=this.loadSingleRow(e[i]);this.determineDisabledRow(n)}},loadSingleRow:function(e){var t=this.get("expandedDataIndex");if(e.length>0){var s="";t>=0&&(s=e[t]);var i=this.rows.length,e=this.rows.create({saveValue:null,data:e,expandedData:s,expandedDataIndex:t,index:i});return e}},removeSingleRow:function(e){this.deselectRow(e.get("saveValue")),e.set("index",this.rows.indexOf(e)),this.rows.remove(e)},addNewRow:function(e){e instanceof Row?this.loadSingleRow(e.get("data")):this.loadSingleRow(e)},removeRow:function(e){var t=this.row(e);"undefined"!=typeof t&&this.removeSingleRow(t)},removeAllRows:function(){for(var e=this.rows.toArray(),t=e.length;t>0;t--)this.removeSingleRow(e[t-1])},toggleRow:function(e){var t=this.row(e);"undefined"==typeof t||this.get("selectionDisable")||("radio"==this.get("inputType")&&this.deselectAll(),this.isSelected(t)?(this.removeSelectedRow(t),EventBus.trigger("deselect:row",e,this)):(this.addSelectedRow(t),EventBus.trigger("select:row",e,this)))},selectRow:function(e){var t=this.row(e);"undefined"==typeof t||this.get("selectionDisable")||("radio"==this.get("inputType")&&this.deselectAll(),this.isSelected(t)||(this.addSelectedRow(t),EventBus.trigger("select:row",e,this)))},deselectRow:function(e){var t=this.row(e);"undefined"!=typeof t&&this.isSelected(t)&&!this.get("selectionDisable")&&(this.removeSelectedRow(t),EventBus.trigger("deselect:row",e,this))},selectSet:function(e){for(var t=0;t<e.length;t++)this.selectRow(e[t]);EventBus.trigger("select:set",e,this)},deselectAll:function(){for(var e=this.selectedRows.length,t=0;e>t;t++)this.selectedRows.pop();EventBus.trigger("deselect:all",this)},selectAll:function(){for(var e=this.rows.length,t=0;e>t;t++)this.addSelectedRow(this.rows.at(t));EventBus.trigger("select:all",this)},addSelectedRow:function(e){e.get("disabled")===!1&&this.selectedRows.add(e)},removeSelectedRow:function(e){this.selectedRows.remove(e)},row:function(e){return this.rows.findWhere({saveValue:e})},hasRow:function(e){return this.row(e)?!0:!1},isSelected:function(e){return this.selectedRows.contains(e)},isSelectedSaveVal:function(e){var t=this.row(e);return this.isSelected(t)},getSelectedSaveVals:function(){var e=[];return this.selectedRows.each(function(t){e.push(t.get("saveValue"))}),e},rowByValue:function(e){return this.row(e)},cellData:function(e,t){var s=[];"undefined"==typeof t&&(t=!1);var i=this.columns.indexByName(e);if(i){colIndex=i.get("index");for(var n=0;n<this.selectedRows.length;n++){var o=this.selectedRows.at(n);t?s.push(o.getCellDataText(colIndex)):s.push(o.getCellDataHtml(colIndex))}}else s=[""];return s},determineDisabledRow:function(e){e.getInput().is(":disabled")&&this.disableRowByModel(e)},disableSingleRow:function(e){this.disableRowByModel(this.rowByValue(e))},disableRowByModel:function(e){e.set("disabled",!0),EventBus.trigger("disable:row",this,e)},enableSingleRow:function(e){var t=this.rowByValue(e);t.set("disabled",!1),EventBus.trigger("enable:row",this,t)}});

// DataTables
var DataTables=Backbone.Collection.extend({initialize:function(){this.model=DataTable}});

// DataTableView
var DataTableView=BaseView.extend({exportRow:null,baseConfig:{bJQueryUI:!0,bDeferRender:!0,bLengthChange:!1,iDisplayLength:15,bProcessing:!0,bAutoWidth:!1,sPaginationType:"full_numbers",aaSorting:[],fnInitComplete:function(e,t){OpButtonController.initTable($(this)),"function"==typeof fnInitComplete&&fnInitComplete(e,t)},fnRowCallback:function(e,t,l){"function"==typeof fnRowCallback&&fnRowCallback(e,t,l,iDisplayIndexFull)},fnPreDrawCallback:function(){},fnDrawCallback:function(){var e=$(this).parents(".dataTableContainer");$table=e.find("table").eq(0);var t=IDT.getTableModel($table);"function"==typeof fnDrawCallback&&fnDrawCallback(e),EventBus.trigger("draw:table",t)},fnCreatedRow:function(){}},events:{'click input[type="checkbox"]':"selectCheckbox",'click input[type="radio"]':"selectRadio","click tr":"selectRow","click .selectAll":"selectAll","click .selectFilter":"selectFiltered","click .selectNone":"selectNone"},initialize:function(){this.$el=this.model.get("$el"),this.listenTo(this.model.selectedRows,"add",this.onAddSelectedRow),this.listenTo(this.model.selectedRows,"remove",this.onRemoveSelectedRow),this.listenTo(this.model.rows,"add",this.onAddRow),this.listenTo(this.model.rows,"remove",this.onRemoveRow),EventBus.on("draw:table",this.onDraw,this),EventBus.on("derender:table",this.deRender,this),EventBus.on("disable:row",this.disableSingleRow,this),EventBus.on("enable:row",this.enableSingleRow,this),EventBus.on("filter:table",this.filterTable,this)},render:function(){var e={aaData:this.model.get("aaData"),aoColumns:this.model.get("aoColumns")};this.determineInputType(e),this.createTransformDom(),this.startupDatatables(e),this.initInfoRow(),this.setStyles(),this.drawSelectAll(),this.isVisible()||this.listenForVisible(),EventBus.trigger("init:table",this.model)},startupDatatables:function(e){var t=$.extend({},this.config,e,this.specificConfig());this.model.loadData(e);var l=this.$el.dataTable(t),i=this.model.get("id");this.model.set("datatable",l),this.model.set("rendered",!0),IDT.dataTables[i]=l},specificConfig:function(){var e={};e.oLanguage=DataTableLanguage.language();var t=[];"none"!=this.model.get("inputType")&&(t[0]=0),e.aoColumnDefs=[{bSortable:!1,aTargets:t,bSearchable:!1},{sDefaultContent:"none",aTargets:["_all"]}];var l=this.model.get("config")||{};return $.extend({},this.baseConfig,e,l)},determineInputType:function(e){var t="none";if(e.aaData.length>0)try{var l=$(e.aaData[0][0]).eq(0);l.length>0&&(l.is('[type="radio"]')||l.find('[type="radio"]').length>0?t="radio":(l.is('input[type="checkbox"]')||l.find('input[type="checkbox"]').length>0)&&(t="checkbox"))}catch(i){}this.model.set("inputType",t)},getHeaderCells:function(){var e=this.$el,t=$("> tbody > tr > th",e),l=$("> tr > th",e),i=$("> thead > tr > td",e),n=$();n=t.length>0?t:l.length>0?l:i.length>0?i:e.find("tr").eq(0);for(var a=[],o=0;o<n.length;o++){var s=n.eq(o);if(s.hasClass("ibisDatatable_expandedData"))a.push({bVisible:!1});else{var r=s.attr("colspan");r||(r=1);for(var c=0;r>c;c++)a.push({sTitle:s.text()})}}return this.model.set("aoColumns",a),n},getBodyRows:function(e){var t=[],l=$("> tbody > tr",e),i=$("> tr",e),n=$();n=l.length>0?l:i;for(var a=0;a<n.length;a++){for(var o=n.eq(a),s=[],r=o.children("td"),c=0;c<r.length;c++)s.push(r.eq(c).html());t.push(s)}return this.model.set("aaData",t),n},setStyles:function(){this.$("thead tr").addClass("tableRowHeader").attr("role","row"),this.$("th").addClass("tableCellHeader").attr("role","columnheader")},drawSelectAll:function(){var e=this.model.get("inputType");if("none"!=e&&"radio"!=e){var t=this.$el.find("th.tableCellHeader").eq(0),l='<nav class="idtNav"><ul><li class="selectAllIcon"><img src="'+baseUrl+'/images/checkbox_unchecked.png" />';l+='<ul><li><a href="javascript:;" class="selectAllMenu selectAll"><img src="'+baseUrl+'/images/checkbox_checked.png" />Select All</a></li>',l+='<li><a href="javascript:;" class="selectAllMenu selectFilter"><img src="'+baseUrl+'/images/checkbox_indeterminate.png" />Select Filtered</a></li>',l+='<li><a href="javascript:;" class="selectAllMenu selectNone"><img src="'+baseUrl+'/images/checkbox_unchecked.png" />Select None</a></li>',l+="</ul></li></nav>",t.html(l),this.determineSelectAllIcon()}},determineSelectAllIcon:function(){var e=this.model.selectedRows.length,t=this.model.rows.length;e==t?this.selectAllIconToChecked():e>0?this.selectAllIconToPartial():this.selectAllIconToUnchecked()},selectAllIconToChecked:function(){var e=this.model.get("inputType");"none"!=e&&"radio"!=e&&this.$(".selectAllIcon > img").attr("src",baseUrl+"/images/checkbox_checked.png")},selectAllIconToPartial:function(){var e=this.model.get("inputType");"none"!=e&&"radio"!=e&&this.$(".selectAllIcon > img").attr("src",baseUrl+"/images/checkbox_indeterminate.png")},selectAllIconToUnchecked:function(){var e=this.model.get("inputType");"none"!=e&&"radio"!=e&&this.$(".selectAllIcon > img").attr("src",baseUrl+"/images/checkbox_unchecked.png")},createTransformDom:function(){},rowHasInput:function(e){var t=IDT.getInputForRow(e);return t.length>0?t:!1},onDraw:function(e){var t=this;_.isEqual(e,this.model)&&this.$el.find("tbody tr").each(function(){var e=$(this),l=IDT.getInputForRow(e),i=IDT.getSaveValue(l);t.model.isSelectedSaveVal(i)?(t.setRowSelected(e),l.prop("checked",!0)):(t.setRowDeselected(e),l.prop("checked",!1))})},onAddSelectedRow:function(e){this.select(e),this.updateSelectedItemCount(),this.determineSelectAllIcon()},onRemoveSelectedRow:function(e){this.deselect(e),this.updateSelectedItemCount(),this.determineSelectAllIcon()},onAddRow:function(e){if(this.model.get("rendered")===!0){var t=this.model.get("datatable");t.fnAddData(e.get("data"))}},onRemoveRow:function(e){if(this.model.get("rendered")===!0){var t=this.model.get("datatable");t.fnDeleteRow(e.get("index"))}},select:function(e){var t=this.getRowJqueryBySaveValue(e.get("saveValue"));t.length>0&&(this.findInputOnRow(t).prop("checked",!0),this.setRowSelected(t))},deselect:function(e){var t=this.getRowJqueryBySaveValue(e.get("saveValue"));t.length>0&&(this.findInputOnRow(t).prop("checked",!1),this.setRowDeselected(t))},setRowSelected:function(e){e.hasClass("row_selected")||e.addClass("row_selected")},setRowDeselected:function(e){e.removeClass("row_selected")},selectCheckbox:function(e){e.stopImmediatePropagation();var t=$(e.target),l=IDT.getSaveValue(t);this.model.toggleRow(l)},selectRadio:function(e){e.stopImmediatePropagation();var t=$(e.target);e.stopImmediatePropagation();var l=IDT.getSaveValue(t);this.model.toggleRow(l)},selectRow:function(e){if(e.stopImmediatePropagation(),!$(e.target).is("a, input, select, label")){var t=IDT.getInputForRow($(e.currentTarget));t.length>0&&this.model.toggleRow(IDT.getSaveValue(t))}},selectAll:function(e){e.stopImmediatePropagation(),this.model.get("disableSelectAll")||this.model.selectAll()},selectFiltered:function(e){if(e.stopImmediatePropagation(),!this.model.get("disableSelectAll")){var t=this.model.get("datatable");try{for(var l=t._("tr",{filter:"applied"}),i=l.length,n=[],a=0;i>a;a++){var o=l[a],s=$(o[0]);s.length>0&&n.push(IDT.getSaveValue(s))}this.model.selectSet(n)}catch(r){this.selectAll(e)}}},selectNone:function(e){e.stopImmediatePropagation(),this.model.get("disableSelectAll")||this.model.deselectAll()},disableSingleRow:function(e,t){if(_.isEqual(e,this.model)){var l=t.get("saveValue"),i=this.getRowJqueryBySaveValue(l);this.findInputOnRow(i).prop("disabled",!0)}},enableSingleRow:function(e,t){if(_.isEqual(e,this.model)){var l=t.get("saveValue"),i=this.getRowJqueryBySaveValue(l);this.findInputOnRow(i).prop("disabled",!1)}},getRowJqueryBySaveValue:function(e){var t=IDT.cleanSaveVal(e),l=this.$('input[id="'+t+'"]');if(l.length>0)return l.parents("tr").eq(0);if(l=this.$('input[value="'+t+'"]'),l.length>0)return l.parents("tr").eq(0);var i=$();return this.$("tr").each(function(){var t=$(this),l=t.text();return l==e?void(i=t):void 0}),i},findInputOnRow:function(e){return e.find("input").eq(0)},initInfoRow:function(){this.getExportRow(),this.placeExportRow(),this.createSelectedItemsLabel()},getInfoRow:function(){return this.$el.parents(".dataTableContainer").find(".dataTables_info")},getSelectedItemsContainer:function(){return this.$el.parents(".dataTableContainer").find(".rowCount")},getRowWordContainer:function(){return this.$el.parents(".dataTableContainer").find(".rowWord")},placeExportRow:function(){var e=this.model.get("exportRow");if(null!==e){var t=$("<div></div>");t.css("float","left").addClass("tableExportAction").html(e);var l=this.getInfoRow();l.length>0&&l.after(t)}},getExportRow:function(){var e=this.$el.find("tr.tableRowAction");e.length>0&&this.model.set("exportRow",this.$el.find("td.tableCellAction").html()),e.parents("tr").eq(0).remove()},removeExportRow:function(){null!==this.model.get("exportRow")&&this.$el.find("td.tableCellAction").parents("tr").last().remove()},createSelectedItemsLabel:function(){if(this.getSelectedItemsContainer().length<1&&"none"!=this.model.get("inputType")){var e=this.getInfoRow(),t=$('<div class="rowCountContainer">(<span class="rowCount">0</span> <span class="rowWord">Rows</span> Selected)</div>');e.after(t)}},updateSelectedItemCount:function(){this.createSelectedItemsLabel();var e=this.model.selectedRows.length,t=this.getSelectedItemsContainer();t.text(e),this.updateRowWord(e)},getCountSelectedItems:function(){return this.getSelectedItemsContainer().text()},updateRowWord:function(e){var t="Rows";1==e&&(t="Row"),this.getRowWordContainer().text(t)},filterTable:function(e,t){_.isEqual(e,this.model)&&e.get("datatable").fnFilter(t)},isVisible:function(){return this.$el.is(":visible")},listenForVisible:function(){var e=500,t=this;this.isVisible()?IDT.recalculateHeaderFooterWidths(this.$el):setTimeout(function(){t.listenForVisible.call(t)},e)},deRender:function(e){_.isEqual(e,this.model)&&this.close()},close:function(){EventBus.off("draw:table",this.onDraw,this),EventBus.off("derender:table",this.deRender,this),EventBus.off("filter:table",this.filterTable,this);var e=this.model.get("datatable");e.fnDestroy(),DataTableView.__super__.close.call(this)},destroy:function(){this.close(),DataTableView.__super__.destroy.call(this)}});

// DataTableViews
var DataTableViews=Backbone.Collection.extend({initialize:function(){this.model=DataTableView}});

// IBISDataTables
var IbisDataTables=IDT={dataTables:{},tableReferences:[],models:null,isStarted:!1,initialize:function(){this.models=new DataTables,this.isStarted=!0},createNewTable:function(a){var b=this.getId(a),c=new DataTable({$el:a,id:b}),d=new DataTableView({model:c});return this.models.add(c),d},getTableModel:function(a){var b=this.getId(a);return this.models.findWhere({id:b})},buildSingleData:function(a,b,c){this.isStarted||this.initialize(),b.empty().addClass("table"),"undefined"==typeof c&&(c=this.createNewTable(b)),c.model.get("aaData").length<1&&(c.model.set("aaData",a.aaData),c.model.set("aoColumns",a.aoColumns),c.model.set("exportRow",a.exportRow),"undefined"!=typeof a.config&&c.model.set("config",a.config)),c.render()},buildSingleDom:function(a){this.isStarted||this.initialize();var b=this.createNewTable(a),c=b.getHeaderCells(),d=c.eq(0).parent("tr");d.remove(),b.getExportRow(),b.getBodyRows(a);var e={aaData:b.model.get("aaData"),aoColumns:b.model.get("aoColumns"),exportRow:b.model.get("exportRow")};this.buildSingleData(e,a,b)},fullBuild:function(a){this.isStarted||this.initialize();var b=a||$(".dataTableContainer > table");b.each(function(){_.defer(function(a){if(!a.hasClass("dataTable"))if(a.find('> script[type="text/json"]').length>0||a.parents(".dataTableContainer").hasClass("dataTableJSON")){var b=JSON.parse(a.find("script").html().trim());IDT.buildSingleData(b,a)}else IDT.buildSingleDom(a)},$(this))})},derenderTable:function(a){var b=this.getTableModel(a);"undefined"!=typeof b&&(EventBus.trigger("derender:table",b),this.models.remove(b))},isInit:function(a){var b=this.getTableModel(a);return"undefined"!=typeof b&&!!this.dataTables[b.get("id")]},getId:function(a){if(null!=a.attr("id"))return a.attr("id");var b=null;if(a.hasClass("dataTableContainer")&&"undefined"!=typeof a.attr("id"))b=a.attr("id");else{var b=a.parents(".dataTableContainer").eq(0).attr("id");null!=b&&(b+="_table")}return null==b&&(b=window.location.pathname.split(".")[0].replace(/\//g,"_")+"_"+$(".dataTableContainer > table, .dataTableContainer > .dataTables_wrapper > table").index(a)),a.attr("id",b),b},getInputForRow:function(a){return a.find("td").eq(0).find("input")},getVisTableRowInputs:function(a){var b=a.find("tbody tr"),c=$();return b.each(function(){c=c.add($(this).find('input[type="checkbox"], input[type="radio"]').eq(0))}),c},hasRowValue:function(a,b){var c=this.getTableModel(a),d=!1;return c.rows.forEach(function(a){if(a.get("saveValue")==b)return void(d=!0)}),d},getSaveValue:function(a){var b=a;"undefined"!=typeof a.cid&&(b=a.getInput());var c=b.attr("id"),d=b.attr("value"),e="";return e=c&&null!=c?this.cleanSaveVal(c):d&&null!=d?this.cleanSaveVal(d):b.parents("tr").eq(0).text()},cleanSaveVal:function(a){return IDT.isSaveValClean(a)||(a=a.replace(/\./g,"\\.").replace(/ /g,"\\ ")),a},isSaveValClean:function(a){var b=a.indexOf(".")>-1,c=a.indexOf(" ")>-1,d=a.indexOf("\\.")>-1,e=a.indexOf("\\ ")>-1;return(!b||d)&&(!c||e)},setRowSelected:function(a){var b=this.getInputForRow(a),c=this.getSaveValue(b),d=this.getTable(a);"undefined"!=typeof d&&this.getTableModel(d).selectRow(c)},setRowDeselected:function(a){var b=this.getInputForRow(a),c=this.getSaveValue(b),d=this.getTable(a);"undefined"!=typeof d&&this.getTableModel(d).deselectRow(c)},hasOption:function(a,b){var c=this.getTableModel(a);return c.hasRow(b)},isSelectedOption:function(a,b,c){"undefined"==typeof c&&(c=this.getTable(a)),"undefined"==typeof b&&(b=this.getSaveValue(a));var d=this.getTableModel(c);return d.isSelectedSaveVal(b)},addSelectedOption:function(a,b,c){"undefined"==typeof c&&(c=this.getTable(a)),"undefined"==typeof b&&(b=this.getSaveValue(a));var d=this.getTableModel(c);d.selectRow(b)},addSelectedOptionValue:function(a,b){var c=this.getTableModel(a);c.selectRow(b)},removeSelectedOption:function(a,b,c){"undefined"==typeof c&&(c=this.getTable(a)),"undefined"==typeof b&&(b=this.getSaveValue(a));var d=this.getTableModel(c);d.deselectRow(b)},removeSelectedOptionValue:function(a,b){var c=this.getTableModel(a);c.deselectRow(b)},clearSelected:function(a){var b=this.getTableModel(a);b.deselectAll()},addRow:function(a,b){var c=this.getTableModel(a);if(null!=b)if(_.isArray(b))if(b[0]instanceof Row||_.isArray(b[0]))for(var d=0;d<b.length;d++)c.addNewRow(b[d]);else c.addNewRow(b);else c.addNewRow(b)},removeRow:function(a,b){var c=this.getTableModel(a);if(null!=b&&_.isArray(b))for(var d=0;d<b.length;d++)c.removeRow(b[d]);else c.removeRow(b)},removeAllRows:function(a){var b=this.getTableModel(a);b.removeAllRows()},getTable:function(a){var b=a;a.hasClass("dataTableContainer")||(b=a.parents(".dataTableContainer").eq(0));var c=b.find("table").eq(0);return"undefined"==typeof c?null:$(c)},getTableContainer:function(a){var b=a.parents(".dataTableContainer").eq(0);return"undefined"==typeof b?null:b},getSelectedOptions:function(a){var b=this.getTableModel(a);return b.getSelectedSaveVals()},getSelectedOptionsJq:function(a){var b=this.getSelectedOptions(a),c=$();if(b.length>0)for(var d=IDT.getVisTableRowInputs(a),e=0;e<d.length;e++){var f=d.eq(e),g=IDT.getSaveValue(f);b.indexOf(g)!==-1&&(c=c.add(f))}return c},setSelectedOptions:function(a,b){var c=this.getTableModel(a);c.deselectAll(),c.selectSet(b)},countSelectedOptions:function(a){var b=this.getTableModel(a);return b.selectedRows.length},disableSelection:function(a){var b=this.getTableModel(a);b.set("selectionDisable",!0),a.find("input").prop("disabled",!0)},enableSelection:function(a){var b=this.getTableModel(a);b.set("selectionDisable",!1),a.find("input").prop("disabled",!1)},disableSingleRow:function(a,b){var c=this.getTableModel(a),d="";d=b instanceof jQuery?IDT.getSaveValue(IDT.getInputForRow($row)):b,c.disableSingleRow(d)},enableSingleRow:function(a,b){var c=this.getTableModel(a),d="";d=b instanceof jQuery?IDT.getSaveValue(IDT.getInputForRow($row)):b,c.enableSingleRow(d)},disableSelectAll:function(a){var b=this.getTableModel(a);b.set("disableSelectAll",!0)},enableSelectAll:function(a){var b=this.getTableModel(a);b.set("disableSelectAll",!1)},filterTable:function(a,b){var c=this.getTableModel(a);EventBus.trigger("filter:table",c,b)},saveTableState:function(a,b){},loadTableState:function(a){},changeCheckboxSelection:function(a,b,c){"undefined"==typeof b&&(b=!0),"undefined"!=typeof c&&c.stopPropagation();var d=IDT.getSaveValue(a);a.prop("disabled",!0),setTimeout(function(){a.prop("disabled",!1)},250),this.model.toggleRow(d)},recalculateHeaderFooterWidths:function(a){a.each(function(){var a=$(this).parents(".dataTableContainer"),b=10;"Explorer"==BrowserDetect.browser&&(b+=2),a.find(".fg-toolbar").width($(this).width()-b)})},getCellContent:function(a,b,c){var d=this.getTableModel(a);return d.cellData(b,c)},getCountRows:function(a){var b=this.getTableModel(a);return b.rows.length}};

